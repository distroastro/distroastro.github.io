      FUNCTION CMAROT(DMJD,TRI,KPAR)
      
      DOUBLE PRECISION DMJD,T,AL,F,D,AN,C,AP,AMP,AD,W,CW,U,AMF,DPT,AMQ,H
      DIMENSION TRI(62),PER(62),ARG(5,62),AMP(62),AP(5),AD(5),ARF(5,32)
     .,AMF(21),AMQ(62)
     
C     CORRECTIONS A AJOUTER A UT1(KPAR=1)    EN SECONDES
C                             DELTA(KPAR=2)   EN SECONDES
C                             OMEGA(KPAR=3)   EN 10**-14 RAD/S
C     POUR LES LIBERER DE L EFFET DES MAREES TERRESTRES ZONALES
C      A LA DATE DMJD (MJD), REAL*8
C
C     SELON YODER ET AL. 1981,JGR 86,B2,881-891,  TABLE1
C
C     LE TABLEAU TRI PERMET DE CHOISIR LES TERMES A PRENDRE
C     EN COMPTE : OUI SI TRI(I)=1
C                 NON SI TRI(I)=0  ,I=1,62
C
C                 ****** ENGLISH ABSTRACT   ******
C
C      CORRECTION TO ADD TO UT1,DURATION OF THE DAY OR ANGULAR VELOCITY
C        (VALUE OF KPAR :    1         2                     3 )
C      TO FREE THEM  OF THE EFFECT OF ZONAL TIDES
C      THE PARAMETER TRI ALLOWS TO CHOOSE THE RETAINED WAVES
C      SET TRI(I) = 1 TO RETAIN THE WAVE NUMBER I
C      SET TRI(I) = 0 TO IGNORE IT
C                        ****************
C
      DATA ARG /
     . 1., 0., 2., 2., 2., 2., 0., 2., 0., 1., 2., 0., 2., 0., 2.,
     . 0., 0., 2., 2., 1., 0., 0., 2., 2., 2., 1., 0., 2., 0., 0.,
     . 1., 0., 2., 0., 1., 1., 0., 2., 0., 2., 3., 0., 0., 0., 0.,
     .-1., 0., 2., 2., 1.,-1., 0., 2., 2., 2., 1., 0., 0., 2., 0.,
     . 2., 0., 2.,-2., 2., 0., 1., 2., 0., 2., 0., 0., 2., 0., 0.,
     . 0., 0., 2., 0., 1., 0., 0., 2., 0., 2., 2., 0., 0., 0.,-1.,
     . 2., 0., 0., 0., 0., 2., 0., 0., 0., 1., 0.,-1., 2., 0., 2.,
     . 0., 0., 0., 2.,-1., 0., 0., 0., 2., 0., 0., 0., 0., 2., 1.,
     . 0.,-1., 0., 2., 0., 1., 0., 2.,-2., 1., 1., 0., 2.,-2., 2.,
     . 1., 1., 0., 0., 0.,-1., 0., 2., 0., 0.,-1., 0., 2., 0., 1.,
     .160*0./
      DATA ARF/
     .-1., 0., 2., 0., 2., 1., 0., 0., 0.,-1., 1., 0., 0., 0., 0.,
     . 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 1.,-1., 0., 0., 0.,
     .-1., 0., 0., 2.,-1.,-1., 0., 0., 2., 0.,-1., 0., 0., 2., 1.,
     . 1., 0.,-2., 2.,-1.,-1.,-1., 0., 2., 0.,
     . 0., 2., 2.,-2., 2., 0., 1., 2.,-2., 1., 0., 1., 2.,-2., 2.,
     . 0., 0., 2.,-2., 0., 0., 0., 2.,-2., 1., 0., 0., 2.,-2., 2.,
     . 0., 2., 0., 0., 0., 2., 0., 0.,-2.,-1., 2., 0., 0.,-2., 0.,
     . 2., 0., 0.,-2., 1., 0.,-1., 2.,-2., 1., 0., 1., 0., 0.,-1.,
     . 0.,-1., 2.,-2., 2., 0., 1., 0., 0., 0., 0., 1., 0., 0., 1.,
     . 1., 0., 0.,-1., 0., 2., 0.,-2., 0., 0.,-2., 0., 2., 0., 1.,
     .-1., 1., 0., 1., 0., 0., 0., 0., 0., 2., 0., 0., 0., 0., 1./
      DATA AMP /-0.2500D+02,-0.4300D+02,-0.1050D+03,-0.5400D+02,
     .-0.1310D+03,
     .          -0.41000D+02,-0.43700D+03,-0.10560D+04,-0.19000D+02,
     .          -0.87000D+02,-0.21000D+03,-0.81000D+02, 0.23000D+02,
     .           0.27000D+02,-0.31800D+03,-0.34130D+04,-0.82520D+04,
     .           0.23000D+02,-0.36000D+03, 0.19000D+02,-0.26000D+02,
     .          +0.50000D+02,-0.78100D+03,-0.56000D+02,-0.54000D+02,
     .           0.53000D+02, 0.10700D+03, 0.42000D+02, 0.50000D+02,
     .           0.18800D+03, 0.46300D+03, 0.56800D+03,-0.87880D+04,
     .           0.57900D+03, 0.50000D+02,-0.59000D+02, 0.12500D+03,
     .          -0.19400D+04, 0.14000D+03, 0.19000D+02,-0.91000D+02,
     .21*0.D0/
      DATA AMF/
     .  -0.6100D+02,
     . 0.35000D+02,-0.20050D+04, 0.26700D+03, 0.12450D+04,
     .-0.51327D+05,-0.20600D+03, 0.52000D+02,-0.58200D+03,
     . 0.39000D+02,-0.48000D+02, 0.98000D+02, 0.88100D+03,
     .-0.16339D+05,-0.14700D+03, 0.37000D+02,-0.14600D+03,
     . 0.44900D+03, 0.43000D+02, 0.84040D+04,-0.17205D+07/
     
      DO 90 I=31,62
      DO 90 J=1,5
  90  ARG(J,I)=ARF(J,I-30)
      DO 95 I=42,62
  95  AMP(I)=AMF(I-41)
      DO 99  I=1,62
      AMQ(I)=AMP(I)
   99 AMP(I)=-AMP(I)*1.E-07
      AK=0.94
      C=57.2957795D0
      CW=72.921151463D0/86400
      IF(DMJD.GE.45700.D0)
     .CW=72.921151467064D0/86400.
      DPT=2.*3.14159265
      AP(1)=134.9629D0/C
      AP(2)=357.5254D0/C
      AP(3)=93.2728D0/C
      AP(4)=297.8503D0/C
      AP(5)=125.0433D0/C
      AD(1)=13.06499295D0/C
      AD(2)=0.985600258D0/C
      AD(3)=13.22935027D0/C
      AD(4)=12.19074911D0/C
      AD(5)=-0.05295381D0/C
      T=DMJD-51544.5D0
      IF(KPAR.EQ.1) GO TO 200
      IF(KPAR.EQ.2) GO TO 120
      IF(KPAR.EQ.3) GO TO 120
      GO TO 1000
  120 DO 130 I=1,62
      W=0
      DO 125 J=1,5
  125 W=W+AD(J)*ARG(J,I)
  130 AMP(I)=-AMP(I)*W
      IF(KPAR.EQ.2) GO TO 200
      DO 160 I=1,62
  160 AMP(I)=-AMP(I)*CW*1.E+08
  200 U=0
      DO 250 I=1,62
      W=0
      DO 230 J=1,5
  230 W=W+ARG(J,I)*(AP(J)+AD(J)*T)
      H=DMOD(W,DPT)
      W=DCOS(H)
      IF(KPAR.EQ.1) W=DSIN(H)
  250 U=U+TRI(I)*AK*AMP(I)*W
      CMAROT=U
      DO 260 I=1,62
  260 AMP(I)=AMQ(I)
 1000 RETURN
      END
 
